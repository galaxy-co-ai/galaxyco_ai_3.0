# AGENTS.md — GalaxyCo.ai 3.0

This file is the canonical, agent-focused entrypoint for working in this repo.
It complements `README.md` (human-facing) by documenting the exact commands, workflows, and guardrails agents should follow.

## What this repo is
GalaxyCo.ai 3.0 is an AI-native business platform built with:
- Next.js (App Router) + TypeScript (strict)
- Drizzle ORM + Neon Postgres
- Clerk auth
- Tailwind CSS + Radix UI
- Trigger.dev background jobs
- Vitest (unit/integration) + Playwright (E2E)

## Source of truth (read these first)
- Status / “what’s true today”: `docs/status/PROJECT_STATUS.md`
- Auto-generated snapshot (stack + recent commits): `docs/status/AI_CONTEXT.md`
- Repo navigation + structure conventions: `docs/guides/ORGANIZATION_GUIDELINES.md`
- UI patterns + components to use: `docs/guides/DESIGN-SYSTEM.md`
- Agent behavior + doc-size rules: `docs/guides/AGENT_INSTRUCTIONS.md`

## Golden commands (run these; don’t guess)

### Install
```bash
npm ci
```

### Local env
```bash
cp .env.example .env.local
# Fill in real values in .env.local (never commit secrets)

# Optional: validate keys/config (reads .env.local)
npm run env:check
```

### Database (Drizzle)
```bash
# Push schema (common for dev/preview) — creates/updates tables
npm run db:push

# Seed dev data
npm run db:seed

# Studio (DB GUI)
npm run db:studio

# If you are working with migrations explicitly:
npm run db:generate
npm run db:migrate
```

### Dev server
```bash
npm run dev
```

### Quality gates (must pass before you finish)
```bash
npm run lint
npm run typecheck
npm run build
```

### Tests
```bash
# Unit/integration
npm test

# Headless, CI-like run
npm run test:run

# Coverage
npm run test:coverage

# E2E (Playwright)
npx playwright test
```

Notes:
- CI uses Node 20 and runs `npm ci`, then `npm run lint` and `npm run typecheck`.
- Vitest currently runs in CI as “non-blocking for now” (see `.github/workflows/ci.yml`).

## Day-to-day workflow for agents
1. Read the “Source of truth” docs above.
2. Make the smallest change that solves the problem.
3. Keep changes consistent with the design system and existing patterns.
4. Run: `npm run lint`, `npm run typecheck`, and at least relevant tests.
5. If you touch critical flows, run `npm run build`.

## Code + UI standards (high-signal)
- TypeScript strict: no silent `any` expansion.
- Validation: use Zod for API inputs.
- UI: follow `docs/guides/DESIGN-SYSTEM.md`.
  - Prefer canonical primitives in `src/components/ui/*`.
  - `NeptuneButton` exists for backwards compatibility; prefer `Button` for new code unless a feature explicitly standardizes on NeptuneButton.
- Accessibility: ARIA labels where needed, keyboard navigable UI, sensible focus states.
- Logging: prefer project logging utilities; avoid leaving `console.log` in production paths.

## Documentation rules (do not bloat root docs)
Follow `docs/guides/AGENT_INSTRUCTIONS.md`.
Key rule: do not paste large implementation logs into:
- `README.md`
- `docs/status/PROJECT_STATUS.md`

If you need to capture large implementation details, put them in the appropriate `docs/*` file (e.g. historical or phase documents).

## AI_CONTEXT automation
- `docs/status/AI_CONTEXT.md` is generated by `scripts/update-context.js`.
- It is auto-updated on pushes to `main` via `.github/workflows/ai-context.yml`.
- Do not add noisy, manual logs to AI_CONTEXT; keep it concise.

## Background jobs (Trigger.dev)
If you are working on Trigger.dev tasks:
```bash
npm run trigger:dev
```
Config is in `trigger.config.ts` and jobs live in `src/trigger/`.

## Common gotchas
- Env vars are expected in `.env.local` (not `.env`). The verifier script reads `.env.local`.
- Do not commit secrets. Reference env vars by name only.
- Prefer existing patterns and modules; avoid creating “v2” copies of features.

## Where things live
- App routes: `src/app/`
- API routes: `src/app/api/`
- UI primitives: `src/components/ui/`
- Feature components: `src/components/*/`
- DB schema: `src/db/`
- Tests: `tests/` (unit/integration), `tests/e2e/` (Playwright)
